## Praticando com Assembly

Utilizando assembly para copilar o codigo para win32

`nasm -f win32 file.asm`

Comando de desasembly na sintaxe da intel

`objdump -d -M intel file.obj`

Comando de desasembly na sintaxe da AT&T

`objdump -d file.obj`

Linkando 

`golink /entry_main file.obj`


## Programando em Assembly no Windows

**DEV C++**

```
# include <synchapi.h>

int main(){
  Sleep(4000);
}

```
**F7** - Comando para executar linha por linha do Imunity debugger.

Comando para identificar de uma função de um DLL atraves do nome da dll

**CMD** 

Exemplo: `arwin Kernel32.dll Sleep`

**NotePad**

aguarda.asm

```
global _main

section .text

_main:
    xor eax, eax
    mov eax, 9000
    push eax
    mov ebx, 0x754d9010
    call ebx
```    

## Executando comandos SO em Assembly

Exemplo de abertura do cmd através de um software feito em assembly.

**teste.asm**

```
extern system
global _main

section .text

_main:
  push 0x00657865 ;00exe
  push 0x2e646d63 ;.cmd
  push esp
  pop eax
  push eax
  mov ebx, 0x76453dc0 ; system
  call ebx
```

`nasm -f win32 teste.asm`

`golink /console /entry _main teste.obj msvcrt.dll`

  
## API do Windows em Assembly

teste2.c

```
#include <windows.h>

int main (){
  ShellExecute(handle, "find", <fully_qualified_path_to_folder>, NULL, NULL, 0);
}
```


teste2.asm

```
extern _MessageBoxA
global _main

section .data
  texto db "www.site.com",0
  titulo db "Keep Learning",0
  
section .text
_main:
  push 0
  push titulo
  push texto
  push 0
  call _MessageBoxA 
```

**CMD**

`nasm -f win32 teste2.asm`

`golink /console /entry _main teste.obj msvcrt.dll`

`teste2.exe`

## ShellExecute em Assembly no Windows

Referência:

https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-shellexecutea


teste3.c

```
#include <windows.h>

int main (){
  ShellExecute(0, "open", "cmd", 0, 0, 0);
}
```

teste2.asm

```
extern _ShellExecuteA
global _main

section .data
  texto db "open",0
  titulo db "cmd",0
  
section .text
_main:
  push 5
  push 0
  push 0
  push cmd
  push tipo
  push 0
  call _sHELLeXECUTEA 
```

**CMD**

`nasm -f win32 teste3.asm`

`golink /console /entry _main teste3.obj Shell32.dll /mix`

`teste3.exe`


## Criando um Download Exec em Assembly








**Referência:**

https://docs.microsoft.com/en-us/windows/win32/api/synchapi/


