## Pentest Interno: Do zero a Domain Admin

## Pentest em ambientes modernos

## Identificando o escopo na rede

`nmap --open -v -sS -p 445 -Pn 192.168.0.0/24 -oG smb.txt`

Obs: Sempre busque otimizar seu tempo, no exemplo acima focamos na porta 445 pois faz parte do nosso escopo e ao inves de varrer varias portas que não iria nos servir focamos em uma porta especifica.

`cat smb.txt | grep "Up" | cut -d " " -f 2 > targets`

`crackmapexec smb targets`

`nmap -v --open -Pn 192.168.0.1`

*Obs:
- Busque identificar dentre os ip encontdos qual possui AD.
- Para identificar se um servidor é AD basta analisar as portas abertas do alvo.
- E caso entrone o servidor tente fazer resoluções de nome
- por exemplo: host IP_POSSIVELALVO IP_DOSERVIDOR


## Capturando hashes na rede

*Obs: Para capturar hashes na rede é preciso ativar o responder em host que pertence a mesms a rede onde os alvos estão localizados e o a configuração do respondender deve estar definido em relação aos IPs somente aqueles que estiverem dentro do scopo e tambem para facilitar o processo de coleta de informações.*


## Validando as credenciais

- smbclient
- crackmapexec
- psexec.py
- metasploit (psexec)







